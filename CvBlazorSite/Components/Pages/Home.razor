@page "/"
@using CvBlazorSite.Models
@inject HttpClient httpClient

<PageTitle>Home</PageTitle>

<MudGrid Class="title" Justify="Justify.SpaceBetween">
    <MudItem xs="8">
        <Animation Effect="@Effect.BounceInLeft" Speed="@TimeSpan.FromMilliseconds(1000)">
            <MudText Class="TitleH1" Typo="Typo.h1" GutterBottom="true">VIKTOR</MudText>
        </Animation>
    </MudItem>
    <MudItem>
        <Animation Effect="@Effect.FadeInUp" Speed="@TimeSpan.FromMilliseconds(1500)" Delay="@TimeSpan.FromMilliseconds(750)">
            <MudText Class="TitleH2" Color="Color.Secondary" Typo="Typo.h2" Align="Align.Right" GutterBottom="true">DEVOPS</MudText>
        </Animation>
    </MudItem>

    <MudItem>
        <Animation Effect="@Effect.FadeInDown" Speed="@TimeSpan.FromMilliseconds(1750)" Delay="@TimeSpan.FromMilliseconds(750)">
            <MudText Class="TitleH2" Color="Color.Secondary" Typo="Typo.h2" GutterBottom="true">ENGINEER</MudText>
        </Animation>
    </MudItem>
    <MudItem>
        <Animation Effect="@Effect.BounceInRight" Speed="@TimeSpan.FromMilliseconds(1250)">
            <MudText Class="TitleH1" Typo="Typo.h1" Align="Align.Right" GutterBottom="true">EDÉN</MudText>
        </Animation>
    </MudItem>
</MudGrid>

<MudPaper Class="siteBlock" Elevation="3">
    <MudText Typo="Typo.h5">Skills</MudText>
    <MudSpacer/>
    <MudDataGrid Items="@_competencies" Dense="true" Breakpoint="Breakpoint.None">
        <Columns>
            <PropertyColumn Property="x => x.Name"/>
            <PropertyColumn Property="x => x.YearsOfExperience" Title="Antal år"/>
            <PropertyColumn Property="x => x.CompetencyLevel" Title="Nivå"/>
        </Columns>
    </MudDataGrid>
</MudPaper>


<MudPaper Class="siteBlock" Style="margin-top: 4rem;" Elevation="3">
    <MudText Typo="Typo.h5">Projekt</MudText>

    <MudContainer Style="margin-top: 2rem;">

        <MudGrid Justify="Justify.Center">
            @foreach (Project project in _projects)
            {
                <ProjectCard Project="@project"/>
            }
        </MudGrid>
    </MudContainer>
</MudPaper>


@code
{
    private IEnumerable<Competency> _competencies = new List<Competency>();
    private IEnumerable<Project> _projects = new List<Project>();

    protected override async Task OnInitializedAsync()
    {
        _competencies = await httpClient.GetFromJsonAsync<List<Competency>>("api/competencies");
        var projects = await httpClient.GetFromJsonAsync<List<Project>>("api/projects");
        _projects = projects.OrderBy(p => p.StartYear).Reverse();
    }

}